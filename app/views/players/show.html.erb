<p id="notice"><%= notice %></p>
<div id="player">
	<div id="card-front">
		<img class="player-picture" src="/images/rosie.png" />
		<div class="player-name">
			<h2><%= @player.name %></h2>
		</div>
	</div>
	<div id="player-stats">
		<table id="name-position">
			<tr>
				<td><%= @player.name %></td>
				<td id="position"><%= @player.position %></td>
			</tr>
		</table>
		<h3>Season Stats</h3>
		<%= render :partial => "season_stats" %>
		<h3>Career Stats</h3>
		<%= render :partial => "career_stats" %>
		<h3>Player Bio</h3>
		<%= render :partial => "bio" %>
	</div>
</div>
<br />
<div id="add-a-game">
<%#	<%= render :partial => "games/form" %> 
<p class="validateTips"></p>
	<table cellspacing="0" cellpadding="0">
		<thead>
			<tr class="scoreboard">
				<th style="text-align:left"><img src="/images/team.png" /></th>
				<th style="text-align:left"><img src="/images/date.png" /></th>
				<th><img src="/images/h.png" /></th>			
				<th><img src="/images/ab.png"></th>
				<th><img src="/images/r.png"></th>
				<th><img src="/images/1b.png"></th>
				<th><img src="/images/2b.png"></th>
				<th><img src="/images/3b.png"></th>
				<th><img src="/images/hr.png"></th>
				<th><img src="/images/rbi.png"></th>
				<th><img src="/images/bb.png"></th>
				<th><img src="/images/k.png"></th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			<%= form_for ([@player, @player.games.build]) do |f| %>
				<tr>
					<td><%= f.text_field :name, :size => 25, :style =>'text-align:left' %></td>
					<td>
						<input id="datepicker" type="text" size="10" style="text-align:left" />
						<%= f.hidden_field 'date' %>
					</td>
					<td><%= f.text_field :hits, :size => 3, :value => 0 %></td>		
					<td><%= f.text_field :at_bats, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :runs, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :singles, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :doubles, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :triples, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :homeruns, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :rbis, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :walks, :size => 3, :value => 0 %></td>
					<td><%= f.text_field :strike_outs, :size => 3, :value => 0 %></td>
					<td><input id= "submit_game", type="button", value="Add Game" />
<%#						<%= f.submit :value => 'Add Game'%>
					</td>
			<% end %>
				</tr>
				<tr>
					<td style="text-align:left">Visitor</td>
					<td></td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td>0</td>
					<td></td>
				</tr>
		</tbody>
	</table>
</div>
<script>
	//<![CDATA[
	$(function() {
		var name = $("#game_name"),
			date = $("#game_date"),
			hits = $("#game_hits"),
			at_bats = $("#game_at_bats"),
			singles = $("#game_singles"),
			doubles = $("#game_doubles"),
			triples = $("#game_triples"),
			homeruns = $("#game_homeruns"),
			allFields = $( [ ] ).add(hits).add(at_bats).add(singles).add(doubles).add(triples).add(homeruns),
			tips = $(".validateTips");
		
		function updateTips(t) {
				tips.show();
				tips.text(t).addClass("ui-state-highlight");
		}
		
		function validateGame() {
			numHits = parseInt(singles.val())+parseInt(doubles.val())+parseInt(triples.val())+parseInt(homeruns.val());
			allFields.parent().removeClass("ui-state-error");
			tips.hide();
			if (parseInt(hits.val()) > parseInt(at_bats.val())) {
				hits.parent().addClass("ui-state-error");
				at_bats.parent().addClass("ui-state-error");
				updateTips("You can't have more hits than at bats!");
				return false;
			} 
			if (parseInt(hits.val()) != numHits) {
				hits.parent().addClass("ui-state-error");
				singles.parent().addClass("ui-state-error");
				doubles.parent().addClass("ui-state-error");
				triples.parent().addClass("ui-state-error");
				homeruns.parent().addClass("ui-state-error");
				updateTips("Your number of hits doesn't add up!");
				return false;			
			} else {
				return true;
			}
		}
	
		$('#submit_game').click(function() {
			var bValid = true;

			bValid = bValid && validateGame();
			
			if (bValid) {
				updateTips("Game passes my awesome validations!");
			} else {

			}			
		})
		
		$('#datepicker').datepicker({
			"altField":"#game_date",
			"altFormat":"yy-mm-dd"
		})	
		
	});
	//]]>
</script>